/*
 * Empty C++ Application
 */


#include "xparameters.h"
#include "xil_io.h"
#include "sleep.h"

//Used object classes
#include "Objects/Frog.h"
#include "Objects/GameObject.h"
#include "Objects/Controls.h"
#include "Objects/Background.h"

#include "definitions.h"

//#include "Objects/background_old.h"
/*
uint16_t bg_type1 = HIGHWAY_TILE;
uint16_t bg_type2 = GRASS_TILE;
uint16_t bg_type3 = HIGHWAY_TILE;
uint16_t bg_type4 = HIGHWAY_TILE;
uint16_t bg_type5 = WATER_TILE;
uint16_t bg_type6 = TRAINWAY_TILE;
uint16_t bg_type7 = GRASS_TILE;
uint16_t bg_nxt = TRAINWAY_TILE;
uint16_t bg_nxt2 = 0;

uint16_t bgy = 256;
uint16_t desiredbgy = 0;
uint8_t bgcounter = 0;

uint16_t car0_y = TILE3_HEIGHT_OFFSET+82;
uint16_t car1_y = TILE1_HEIGHT_OFFSET+82;
uint16_t car2_y = TILE4_HEIGHT_OFFSET+82;
uint16_t car3_y = TILE4_HEIGHT_OFFSET+82;
uint16_t car4_y = TILE3_HEIGHT_OFFSET+82;
*/

int main()
{
	Background objBg = Background();
	Background *playerBg = &objBg;

	Frog objFrog = Frog(446,690,playerBg,1); //args: uint16_t posX, uint16_t posY, uint8_t speed);
	Frog *playerFrog = &objFrog;

	Controls objKeyboard = Controls(playerFrog, playerBg); //args: Frog* ptr
	Controls *playerKeyboard = &objKeyboard;

	GameObject car1 = GameObject(64, 64, 20, TILE1_HEIGHT_OFFSET+82, playerBg, 1, 1, 2, GameObject::Right);
	GameObject car2 = GameObject(64, 64, 350, TILE1_HEIGHT_OFFSET+82, playerBg, 1, 2, 2, GameObject::Right);
	GameObject car3 = GameObject(64, 64, 700, TILE3_HEIGHT_OFFSET+82, playerBg, 1, 3, 2, GameObject::Left);
	GameObject car4 = GameObject(64, 64, 80, TILE3_HEIGHT_OFFSET+82, playerBg, 1, 4, 2, GameObject::Left);
	GameObject car5 = GameObject(64, 64, 450, TILE4_HEIGHT_OFFSET+82, playerBg, 1, 5, 2, GameObject::Right);

	GameObject* gameObjects[] = {&car1, &car2, &car3, &car4, &car5};

	while(1){

		for( int i = 0; i<5; i++){
			gameObjects[i]->draw();
			gameObjects[i]->updatePos();
		}

		playerKeyboard->getKeyboardAction();
		playerFrog->updatePos();
		playerFrog->draw();

		playerBg->update();
		playerBg->draw();

		//if(playerFrog->IsColliding(gameObjects, 5))
		//	playerFrog->reset();

		usleep(2000);
	}
}
